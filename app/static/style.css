/* static/style.css */

/* Added global design tokens so legacy and new components can share one color/radius contract. */
:root {
    /* Added explicit font tokens so typography can be swapped without touching component rules. */
    --font-body: 'Open Sans', sans-serif;
    --font-heading: 'Merriweather', Georgia, serif;

    --color-bg: #ffffff;
    --color-surface: #f8fafc;
    --color-surface-alt: #f1f5f9;
    /* Added muted-surface token to remove fallback-dependent color usage in ingestion status blocks. */
    --color-surface-muted: #f2f4f8;
    --color-border: #e2e8f0;
    --color-border-strong: #cbd5e1;

    --color-text: #1e293b;
    --color-text-muted: #64748b;
    --color-text-subtle: #94a3b8;

    --color-primary: #2563eb;
    --color-primary-muted: rgba(37, 99, 235, 0.12);

    --color-nav-bg: #0f172a;
    --color-nav-active: rgba(255, 255, 255, 0.15);

    --color-success: #047857;
    --color-success-muted: #dcfce7;
    --color-warn: #b45309;
    --color-warn-muted: #fef9c3;
    --color-danger: #b91c1c;
    --color-danger-muted: #fee2e2;
    --color-info: #1d4ed8;
    --color-info-muted: #dbeafe;

    /* Added exhaustive palette aliases so every UI color literal maps through design tokens. */
    --palette-hex-0284c7: #0284c7;
    --palette-hex-047857: #047857;
    --palette-hex-065f46: #065f46;
    --palette-hex-0c4a6e: #0c4a6e;
    --palette-hex-0ea5e9: #0ea5e9;
    --palette-hex-0f172a: #0f172a;
    --palette-hex-10793f: #10793f;
    --palette-hex-166534: #166534;
    --palette-hex-1d4ed8: #1d4ed8;
    --palette-hex-1e293b: #1e293b;
    --palette-hex-1e3a5f: #1e3a5f;
    --palette-hex-1e3a8a: #1e3a8a;
    --palette-hex-1f2937: #1f2937;
    --palette-hex-22d3ee: #22d3ee;
    --palette-hex-2563eb: #2563eb;
    --palette-hex-2980b9: #2980b9;
    --palette-hex-334155: #334155;
    --palette-hex-3498db: #3498db;
    --palette-hex-34d399: #34d399;
    --palette-hex-3730a3: #3730a3;
    --palette-hex-374151: #374151;
    --palette-hex-38bdf8: #38bdf8;
    --palette-hex-4338ca: #4338ca;
    --palette-hex-475569: #475569;
    --palette-hex-4b5563: #4b5563;
    --palette-hex-555: #555;
    --palette-hex-5a6268: #5a6268;
    --palette-hex-60a5fa: #60a5fa;
    --palette-hex-6366f1: #6366f1;
    --palette-hex-64748b: #64748b;
    --palette-hex-6c757d: #6c757d;
    --palette-hex-7dd3fc: #7dd3fc;
    --palette-hex-854d0e: #854d0e;
    --palette-hex-92400e: #92400e;
    --palette-hex-93c5fd: #93c5fd;
    --palette-hex-94a3b8: #94a3b8;
    --palette-hex-95a5a6: #95a5a6;
    --palette-hex-991b1b: #991b1b;
    --palette-hex-a5b4fc: #a5b4fc;
    --palette-hex-b00020: #b00020;
    --palette-hex-b45309: #b45309;
    --palette-hex-b91c1c: #b91c1c;
    --palette-hex-bfdbfe: #bfdbfe;
    --palette-hex-cbd5e1: #cbd5e1;
    --palette-hex-cbd5f5: #cbd5f5;
    --palette-hex-ccc: #ccc;
    --palette-hex-dbeafe: #dbeafe;
    --palette-hex-dc3545: #dc3545;
    --palette-hex-dcfce7: #dcfce7;
    --palette-hex-ddd: #ddd;
    --palette-hex-e0e7ff: #e0e7ff;
    --palette-hex-e0f2fe: #e0f2fe;
    --palette-hex-e2e8f0: #e2e8f0;
    --palette-hex-e5e7eb: #e5e7eb;
    --palette-hex-e6f4ea: #e6f4ea;
    --palette-hex-eaeaea: #eaeaea;
    --palette-hex-eef2ff: #eef2ff;
    --palette-hex-eff6ff: #eff6ff;
    --palette-hex-f0f0f0: #f0f0f0;
    --palette-hex-f0f9ff: #f0f9ff;
    --palette-hex-f1f5f9: #f1f5f9;
    --palette-hex-f2f4f8: #f2f4f8;
    --palette-hex-f3f3f3: #f3f3f3;
    --palette-hex-f3f4f6: #f3f4f6;
    --palette-hex-f5f3ff: #f5f3ff;
    --palette-hex-f87171: #f87171;
    --palette-hex-f8fafc: #f8fafc;
    --palette-hex-f9f9f9: #f9f9f9;
    --palette-hex-f9fafb: #f9fafb;
    --palette-hex-fbbf24: #fbbf24;
    --palette-hex-fde68a: #fde68a;
    --palette-hex-fdecea: #fdecea;
    --palette-hex-fecaca: #fecaca;
    --palette-hex-fee2e2: #fee2e2;
    --palette-hex-fef2f2: #fef2f2;
    --palette-hex-fef3c7: #fef3c7;
    --palette-hex-fef9c3: #fef9c3;
    --palette-hex-fff: #fff;
    --palette-hex-fffbeb: #fffbeb;
    --palette-hex-ffffff: #ffffff;
    --palette-rgba-148-163-184-0-16: rgba(148, 163, 184, 0.16);
    --palette-rgba-148-163-184-0-5: rgba(148, 163, 184, 0.5);
    --palette-rgba-15-23-42-0-05: rgba(15, 23, 42, 0.05);
    --palette-rgba-15-23-42-0-06: rgba(15, 23, 42, 0.06);
    --palette-rgba-15-23-42-0-08: rgba(15, 23, 42, 0.08);
    --palette-rgba-15-23-42-0-12: rgba(15, 23, 42, 0.12);
    --palette-rgba-15-23-42-0-25: rgba(15, 23, 42, 0.25);
    --palette-rgba-15-23-42-0-35: rgba(15, 23, 42, 0.35);
    --palette-rgba-16-185-129-0-1: rgba(16, 185, 129, 0.1);
    --palette-rgba-16-185-129-0-10: rgba(16, 185, 129, 0.10);
    --palette-rgba-16-185-129-0-15: rgba(16, 185, 129, 0.15);
    --palette-rgba-16-185-129-0-25: rgba(16, 185, 129, 0.25);
    --palette-rgba-16-185-129-0-35: rgba(16, 185, 129, 0.35);
    --palette-rgba-239-68-68-0-12: rgba(239, 68, 68, 0.12);
    --palette-rgba-239-68-68-0-25: rgba(239, 68, 68, 0.25);
    --palette-rgba-241-245-249-0-4: rgba(241, 245, 249, 0.4);
    --palette-rgba-248-113-113-0-18: rgba(248, 113, 113, 0.18);
    --palette-rgba-248-113-113-0-35: rgba(248, 113, 113, 0.35);
    --palette-rgba-251-191-36-0-2: rgba(251, 191, 36, 0.2);
    --palette-rgba-251-191-36-0-4: rgba(251, 191, 36, 0.4);
    --palette-rgba-255-255-255-0-1: rgba(255, 255, 255, 0.1);
    --palette-rgba-29-78-216-0-3: rgba(29, 78, 216, 0.3);
    --palette-rgba-37-99-235-0-25: rgba(37, 99, 235, 0.25);
    --palette-rgba-37-99-235-0-3: rgba(37, 99, 235, 0.3);
    --palette-rgba-45-212-191-0-15: rgba(45, 212, 191, 0.15);
    --palette-rgba-59-130-246-0-08: rgba(59, 130, 246, 0.08);
    --palette-rgba-59-130-246-0-1: rgba(59, 130, 246, 0.1);
    --palette-rgba-59-130-246-0-15: rgba(59, 130, 246, 0.15);
    --palette-rgba-59-130-246-0-18: rgba(59, 130, 246, 0.18);
    --palette-rgba-59-130-246-0-2: rgba(59, 130, 246, 0.2);
    --palette-rgba-59-130-246-0-4: rgba(59, 130, 246, 0.4);
    --palette-rgba-6-182-212-0-10: rgba(6, 182, 212, 0.10);
    --palette-rgba-6-182-212-0-12: rgba(6, 182, 212, 0.12);
    --palette-rgba-79-70-229-0-08: rgba(79, 70, 229, 0.08);
    --palette-rgba-79-70-229-0-1: rgba(79, 70, 229, 0.1);
    --palette-rgba-79-70-229-0-12: rgba(79, 70, 229, 0.12);
    --palette-rgba-79-70-229-0-16: rgba(79, 70, 229, 0.16);
    --palette-rgba-79-70-229-0-2: rgba(79, 70, 229, 0.2);
    --palette-rgba-79-70-229-0-25: rgba(79, 70, 229, 0.25);
    --palette-rgba-79-70-229-0-45: rgba(79, 70, 229, 0.45);
    --palette-rgba-99-102-241-0-1: rgba(99, 102, 241, 0.1);
    --palette-rgba-99-102-241-0-15: rgba(99, 102, 241, 0.15);

    --radius-sm: 8px;
    --radius-md: 12px;
    --radius-lg: 18px;
    --radius-pill: 999px;

    --shadow-sm: 0 2px 8px rgba(15, 23, 42, 0.06);
    --shadow-md: 0 8px 24px rgba(15, 23, 42, 0.08);
    --shadow-lg: 0 18px 40px rgba(15, 23, 42, 0.10);
    --shadow-dark: 0 18px 40px rgba(15, 23, 42, 0.30);

    --transition: 0.18s ease;
}

/* Reset and Base Styles */
*, *::before, *::after {
    box-sizing: border-box;
}

body {
    /* Use body token for all running text. */
    font-family: var(--font-body);
    font-size: 16px;
    line-height: 1.6;
    background-color: var(--color-bg);
    color: var(--color-text);
    margin: 0;
    padding: 0;
}

/* Typography */
h1, h2, h3 {
    /* Use serif display token for headings to better fit historical-document context. */
    font-family: var(--font-heading);
    color: var(--color-text);
    margin-bottom: 20px;
}

/* Container */
.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.flash-messages {
    margin: 20px auto 0;
    max-width: 960px;
}

.flash-messages ul {
    list-style: none;
    margin: 0;
    padding: 0;
    display: grid;
    gap: 12px;
}

.flash {
    padding: 14px 16px;
    border-radius: 10px;
    font-weight: 600;
    background: var(--palette-hex-e2e8f0);
    color: var(--palette-hex-1f2937);
    border: 1px solid var(--palette-hex-cbd5f5);
}

.flash--success {
    background: var(--palette-rgba-16-185-129-0-15);
    border-color: var(--palette-rgba-16-185-129-0-35);
    color: var(--palette-hex-065f46);
}

.flash--danger {
    background: var(--palette-rgba-248-113-113-0-18);
    border-color: var(--palette-rgba-248-113-113-0-35);
    color: var(--palette-hex-991b1b);
}

.flash--warning {
    background: var(--palette-rgba-251-191-36-0-2);
    border-color: var(--palette-rgba-251-191-36-0-4);
    color: var(--palette-hex-92400e);
}

/* Header and primary navigation */
.site-header {
    background: var(--color-nav-bg);
    color: var(--palette-hex-f8fafc);
    box-shadow: 0 2px 12px var(--palette-rgba-15-23-42-0-25);
}

.site-header__inner {
    max-width: 1200px;
    margin: 0 auto;
    padding: 16px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 24px;
}

.site-brand {
    /* Keep brand wordmark aligned with the heading serif system. */
    font-family: var(--font-heading);
    font-weight: 700;
    font-size: 1.2rem;
    color: var(--palette-hex-f8fafc);
    text-decoration: none;
    letter-spacing: 0.02em;
}

.primary-nav__list {
    list-style: none;
    display: flex;
    align-items: center;
    gap: 18px;
    margin: 0;
    padding: 0;
    flex-wrap: wrap;
    justify-content: flex-end;
}

.primary-nav a {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    color: var(--palette-hex-e2e8f0);
    text-decoration: none;
    font-weight: 600;
    font-size: 0.95rem;
    padding: 8px 12px;
    border-radius: var(--radius-pill);
    transition: background var(--transition), color var(--transition);
}

.primary-nav a:hover,
.primary-nav a:focus {
    background: var(--palette-rgba-148-163-184-0-16);
    color: var(--palette-hex-f8fafc);
}

.primary-nav a.is-active {
    background: var(--color-nav-active);
    color: var(--palette-hex-ffffff);
}

.primary-nav__more {
    position: relative;
}

.primary-nav__more-btn {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    color: var(--palette-hex-e2e8f0);
    background: none;
    border: none;
    font-weight: 600;
    font-size: 0.95rem;
    padding: 8px 12px;
    border-radius: var(--radius-pill);
    cursor: pointer;
    transition: background var(--transition), color var(--transition);
}

.primary-nav__more-btn:hover,
.primary-nav__more-btn:focus,
.primary-nav__more-btn.is-active {
    background: var(--palette-rgba-148-163-184-0-16);
    color: var(--palette-hex-f8fafc);
    outline: none;
}

.primary-nav__dropdown {
    display: none;
    position: absolute;
    top: calc(100% + 8px);
    right: 0;
    list-style: none;
    margin: 0;
    padding: 6px;
    background: var(--palette-hex-1e293b);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-dark);
    min-width: 180px;
    z-index: 100;
}

.primary-nav__dropdown.is-open {
    display: block;
}

.primary-nav__dropdown a {
    display: block;
    padding: 8px 12px;
    color: var(--palette-hex-e2e8f0);
    text-decoration: none;
    font-size: 0.9rem;
    border-radius: var(--radius-sm);
    transition: background var(--transition);
}

.primary-nav__dropdown a:hover,
.primary-nav__dropdown a.is-active {
    background: var(--palette-rgba-255-255-255-0-1);
    color: var(--palette-hex-fff);
}

.site-main {
    padding-bottom: 60px;
    min-height: calc(100vh - 96px);
}

/* Navigation Buttons */
.nav-button {
    display: inline-block;
    padding: 8px 12px;
    margin-right: 5px;
    background-color: var(--palette-hex-3498db);
    color: var(--palette-hex-fff);
    text-decoration: none;
    border-radius: 4px;
    transition: background-color 0.3s ease;
    font-size: 14px;
    text-align: center;
}

.nav-button:hover {
    background-color: var(--palette-hex-2980b9);
}

.nav-button.disabled {
    background-color: var(--palette-hex-6c757d);
    pointer-events: none;
    cursor: default;
}

.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    border: 0;
}

/* Forms */
.search-field {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
    align-items: center;
}

.search-page {
    display: grid;
    gap: 24px;
}

.search-page__header {
    display: grid;
    gap: 12px;
}

.search-form {
    background: var(--palette-hex-ffffff);
    border: 1px solid var(--palette-hex-e2e8f0);
    border-radius: 16px;
    padding: 24px;
    display: grid;
    gap: 20px;
    box-shadow: 0 12px 28px var(--palette-rgba-15-23-42-0-08);
}

.search-form__fields {
    display: grid;
    gap: 16px;
}

.search-form__actions {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
}

.search-page__meta {
    font-weight: 600;
    color: var(--palette-hex-334155);
}

.search-page__results {
    display: grid;
    gap: 16px;
}

.search-list-only-banner {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    padding: 14px 16px;
    border-radius: 12px;
    border: 1px solid var(--palette-hex-dbeafe);
    background: var(--palette-hex-eff6ff);
}

.search-list-only-banner__text {
    display: grid;
    gap: 2px;
    color: var(--palette-hex-1e3a8a);
}

.search-list-only-banner__text strong {
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 0.04em;
}

.search-list-only-banner__text span {
    color: var(--palette-hex-334155);
}

/* Semantic search page styles share the base search layout contract. */
.semantic-search-fields {
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
}

.semantic-search-field {
    display: grid;
    gap: 8px;
}

.semantic-search-field input[type="number"] {
    padding: 10px;
    border: 1px solid var(--palette-hex-ccc);
    border-radius: 4px;
    font-size: 16px;
}

.semantic-search-field--small {
    max-width: 240px;
}

.semantic-results {
    background: var(--palette-hex-ffffff);
    border: 1px solid var(--palette-hex-e2e8f0);
    border-radius: 16px;
    padding: 24px;
    display: grid;
    gap: 14px;
    box-shadow: 0 12px 28px var(--palette-rgba-15-23-42-0-08);
}

.semantic-results .help-text {
    margin: 0;
    color: var(--palette-hex-475569);
}

.semantic-results__list {
    display: grid;
    gap: 12px;
}

.semantic-view-toggle {
    display: inline-flex;
    gap: 8px;
    flex-wrap: wrap;
}

.semantic-view-toggle__btn {
    padding: 8px 14px;
    border-radius: 999px;
    border: 1px solid var(--palette-hex-cbd5e1);
    background: var(--palette-hex-f8fafc);
    color: var(--palette-hex-334155);
    font-size: 0.88rem;
    font-weight: 700;
    cursor: pointer;
}

.semantic-view-toggle__btn.is-active {
    background: var(--palette-hex-dbeafe);
    border-color: var(--palette-hex-93c5fd);
    color: var(--palette-hex-1d4ed8);
}

.semantic-results__empty {
    margin: 0;
    padding: 14px;
    border-radius: 10px;
    background: var(--palette-hex-f8fafc);
    color: var(--palette-hex-64748b);
    border: 1px dashed var(--palette-hex-cbd5e1);
}

.result-card {
    display: grid;
    grid-template-columns: auto auto 1fr;
    gap: 14px;
    align-items: flex-start;
    padding: 14px 16px;
    border-radius: 12px;
    border: 1px solid var(--palette-hex-e2e8f0);
    background: var(--palette-hex-f9fafb);
}

.result-card__rank {
    min-width: 42px;
    font-weight: 700;
    color: var(--palette-hex-334155);
}

.result-card__score {
    display: grid;
    gap: 4px;
}

.score-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 64px;
    padding: 3px 10px;
    border-radius: 999px;
    font-weight: 700;
    color: var(--palette-hex-1d4ed8);
    background: var(--palette-hex-dbeafe);
}

.score-distance {
    color: var(--palette-hex-64748b);
    font-size: 0.75rem;
}

.result-card__body h3 {
    margin: 0;
    font-size: 1rem;
}

.result-date {
    font-family: var(--font-body);
    font-weight: 600;
    color: var(--palette-hex-64748b);
    font-size: 0.9rem;
}

.result-snippet {
    margin: 8px 0 0;
    color: var(--palette-hex-475569);
}

.result-link {
    display: inline-block;
    margin-top: 10px;
    font-weight: 600;
    color: var(--palette-hex-1d4ed8);
    text-decoration: none;
}

.result-link:hover {
    text-decoration: underline;
}

.semantic-meaning {
    display: grid;
    gap: 14px;
}

.semantic-meaning__summary {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 10px;
}

.semantic-meaning__stat {
    border: 1px solid var(--palette-hex-e2e8f0);
    border-radius: 10px;
    padding: 10px 12px;
    background: var(--palette-hex-f8fafc);
    display: grid;
    gap: 3px;
}

.semantic-meaning__stat span {
    font-size: 0.75rem;
    color: var(--palette-hex-64748b);
    text-transform: uppercase;
    letter-spacing: 0.04em;
    font-weight: 700;
}

.semantic-meaning__stat strong {
    color: var(--palette-hex-0f172a);
    font-size: 1.05rem;
}

.semantic-meaning__bands,
.semantic-meaning__interpretation {
    margin: 0;
    color: var(--palette-hex-475569);
}

.semantic-meaning__terms {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.semantic-term-chip {
    display: inline-flex;
    align-items: center;
    padding: 4px 10px;
    border-radius: 999px;
    border: 1px solid var(--palette-hex-cbd5e1);
    background: var(--palette-hex-f8fafc);
    color: var(--palette-hex-334155);
    font-size: 0.82rem;
    font-weight: 600;
}

.semantic-term-chip--muted {
    color: var(--palette-hex-64748b);
}

.semantic-meaning__docs h3 {
    margin: 2px 0 0;
    font-size: 1rem;
}

.semantic-meaning__doc-list {
    display: grid;
    gap: 10px;
    margin-top: 8px;
}

.semantic-doc-card {
    border: 1px solid var(--palette-hex-e2e8f0);
    border-radius: 12px;
    padding: 12px 14px;
    background: var(--palette-hex-f9fafb);
}

.semantic-doc-card__top {
    display: flex;
    justify-content: space-between;
    gap: 12px;
    align-items: baseline;
}

.semantic-doc-card__top strong {
    color: var(--palette-hex-0f172a);
}

.semantic-doc-card__score {
    font-size: 0.82rem;
    color: var(--palette-hex-1d4ed8);
    font-weight: 700;
}

.semantic-doc-card__meta {
    margin: 4px 0 0;
    color: var(--palette-hex-64748b);
    font-size: 0.84rem;
}

.semantic-doc-card__snippet {
    margin: 8px 0 0;
    color: var(--palette-hex-475569);
}

@media (max-width: 800px) {
    .result-card {
        grid-template-columns: 1fr;
        gap: 8px;
    }

    .semantic-doc-card__top {
        flex-direction: column;
        align-items: flex-start;
        gap: 4px;
    }
}

input[type="text"],
select {
    padding: 10px;
    border: 1px solid var(--palette-hex-ccc);
    border-radius: 4px;
    font-size: 16px;
}

.form-field__hint {
    margin: 4px 0 0;
    font-size: 0.85rem;
    color: var(--palette-hex-64748b);
}

/* Buttons */
button {
    padding: 10px 20px;
    background-color: var(--palette-hex-3498db);
    color: var(--palette-hex-fff);
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.3s ease;
    font-size: 16px;
}

button:hover {
    background-color: var(--palette-hex-2980b9);
}

button.secondary,
.agent-actions .secondary {
    background-color: var(--palette-hex-6c757d);
}

button.secondary:hover,
.agent-actions .secondary:hover {
    background-color: var(--palette-hex-5a6268);
}

.button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 10px 20px;
    border-radius: 999px;
    background: linear-gradient(135deg, var(--palette-hex-2563eb), var(--palette-hex-1d4ed8));
    color: var(--palette-hex-ffffff);
    font-weight: 600;
    text-decoration: none;
    box-shadow: 0 16px 28px var(--palette-rgba-37-99-235-0-25);
    transition: transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
}

.button:hover,
.button:focus {
    transform: translateY(-1px);
    filter: brightness(1.05);
    box-shadow: 0 18px 36px var(--palette-rgba-37-99-235-0-3);
}

.button--secondary,
.button.button--secondary,
.button.secondary {
    background: var(--palette-hex-475569);
    box-shadow: none;
}

.button--secondary:hover,
.button--secondary:focus,
.button.secondary:hover,
.button.secondary:focus {
    background: var(--palette-hex-334155);
}

/* Search Box Styles */
#searchContainer {
    margin-top: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
}

#searchInput {
    flex: 1;
    padding: 8px;
    font-size: 16px;
}

#searchButton {
    padding: 8px 16px;
    font-size: 16px;
    cursor: pointer;
    border: none;
    background-color: var(--palette-hex-3498db);
    color: white;
    border-radius: 5px;
}

#searchButton:hover {
    background-color: var(--palette-hex-2980b9);
}

/* Search terms explorer */
.search-terms-page {
    display: grid;
    gap: 24px;
}

.search-terms__header {
    display: grid;
    gap: 10px;
}

.search-terms__header h1 {
    margin-bottom: 4px;
}

.search-terms__steps {
    margin: 0;
    padding-left: 20px;
    color: var(--palette-hex-475569);
}

.search-terms__steps li {
    margin: 2px 0;
}

.search-terms__chips {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.search-terms__chip {
    border: 1px solid var(--palette-hex-cbd5e1);
    background: var(--palette-hex-f8fafc);
    color: var(--palette-hex-0f172a);
    border-radius: 999px;
    padding: 8px 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
}

.search-terms__chip:hover,
.search-terms__chip:focus,
.search-terms__chip.is-active {
    background: var(--palette-hex-e0f2fe);
    border-color: var(--palette-hex-0ea5e9);
    color: var(--palette-hex-0c4a6e);
    outline: none;
}

.search-terms__filters {
    display: flex;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;
}

.search-terms__filters select {
    min-width: 240px;
}

.search-terms__controls {
    display: grid;
    gap: 8px;
}

.search-terms__controls input {
    max-width: 460px;
}

.search-terms__crosstab-controls {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 10px 12px;
    align-items: end;
}

.search-terms__crosstab-controls input {
    width: 100%;
}

.search-terms__crosstab-controls button {
    align-self: stretch;
}

.search-terms__tabs {
    display: inline-flex;
    gap: 10px;
    border-bottom: 1px solid var(--palette-hex-e2e8f0);
    padding-bottom: 8px;
}

.search-terms__tab {
    border: 1px solid var(--palette-hex-cbd5e1);
    background: var(--palette-hex-f8fafc);
    color: var(--palette-hex-334155);
    border-radius: 10px;
    padding: 8px 14px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s ease;
}

.search-terms__tab:hover,
.search-terms__tab:focus {
    border-color: var(--palette-hex-94a3b8);
    outline: none;
}

.search-terms__tab.is-active {
    background: var(--palette-hex-0ea5e9);
    border-color: var(--palette-hex-0284c7);
    color: var(--palette-hex-ffffff);
}

.search-terms__meta {
    display: flex;
    gap: 24px;
    flex-wrap: wrap;
    font-weight: 600;
    color: var(--palette-hex-334155);
}

.search-terms__panel {
    background: var(--palette-hex-ffffff);
    border-radius: 16px;
    padding: 20px;
    box-shadow: 0 14px 28px var(--palette-rgba-15-23-42-0-08);
    border: 1px solid var(--palette-hex-e2e8f0);
    display: grid;
    gap: 14px;
}

.search-terms__panel h2 {
    margin-top: 0;
    margin-bottom: 0;
}

.search-terms__summary {
    margin: 0;
    color: var(--palette-hex-475569);
    font-weight: 600;
}

.search-terms__metric-note {
    color: var(--palette-hex-64748b);
    font-size: 0.82rem;
}

.search-terms__empty {
    color: var(--palette-hex-b91c1c);
    font-weight: 600;
}

.search-terms__table-wrapper {
    overflow-x: auto;
}

.search-terms__table {
    width: 100%;
    border-collapse: collapse;
    background: var(--palette-hex-ffffff);
}

.search-terms__table th,
.search-terms__table td {
    border-bottom: 1px solid var(--palette-hex-e2e8f0);
    text-align: left;
    padding: 12px 10px;
    vertical-align: middle;
}

.search-terms__table th {
    font-size: 0.85rem;
    letter-spacing: 0.02em;
    text-transform: uppercase;
    color: var(--palette-hex-475569);
}

.search-terms__term {
    font-weight: 600;
    color: var(--palette-hex-0f172a);
    word-break: break-word;
}

.search-terms__count-wrap {
    display: grid;
    gap: 6px;
    min-width: 130px;
}

.search-terms__count-wrap span {
    font-weight: 700;
    color: var(--palette-hex-0f172a);
}

.search-terms__count-bar {
    height: 7px;
    border-radius: 999px;
    background: var(--palette-hex-e2e8f0);
    overflow: hidden;
}

.search-terms__count-bar span {
    display: block;
    height: 100%;
    border-radius: 999px;
    background: linear-gradient(90deg, var(--palette-hex-0284c7), var(--palette-hex-22d3ee));
}

.search-terms__actions {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.search-terms__action-link,
.search-terms__action-button {
    border: 1px solid var(--palette-hex-cbd5e1);
    background: var(--palette-hex-f8fafc);
    color: var(--palette-hex-1e293b);
    border-radius: 8px;
    padding: 6px 10px;
    font-size: 0.85rem;
    font-weight: 600;
    text-decoration: none;
    cursor: pointer;
}

.search-terms__action-link:hover,
.search-terms__action-link:focus,
.search-terms__action-button:hover,
.search-terms__action-button:focus {
    border-color: var(--palette-hex-0ea5e9);
    color: var(--palette-hex-0c4a6e);
    background: var(--palette-hex-e0f2fe);
    outline: none;
}

@media (max-width: 720px) {
    .search-terms__meta {
        gap: 10px 16px;
    }

    .search-terms__tabs {
        width: 100%;
    }

    .search-terms__tab {
        flex: 1;
        text-align: center;
    }
}

/* Document list */
.document-list-page {
    display: grid;
    gap: 24px;
}

.document-list__header h1 {
    margin-bottom: 8px;
}

.document-list__header p {
    margin: 0;
    color: var(--palette-hex-475569);
}

.document-list__items {
    list-style: none;
    margin: 0;
    padding: 0;
    display: grid;
    gap: 12px;
}

.document-list__link {
    display: block;
    padding: 14px 18px;
    background: var(--palette-hex-ffffff);
    border-radius: 12px;
    border: 1px solid var(--palette-hex-e2e8f0);
    color: var(--palette-hex-0f172a);
    font-weight: 600;
    text-decoration: none;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.document-list__link:hover,
.document-list__link:focus {
    transform: translateY(-1px);
    box-shadow: 0 12px 24px var(--palette-rgba-15-23-42-0-12);
}

.document-list__empty {
    font-style: italic;
    color: var(--palette-hex-64748b);
}

/* Home page */
.home {
    display: grid;
    gap: 32px;
}

.home-tabs {
    background: var(--palette-hex-ffffff);
    border-radius: 18px;
    border: 1px solid var(--palette-hex-e2e8f0);
    box-shadow: 0 18px 34px var(--palette-rgba-15-23-42-0-08);
    padding: 20px;
    display: grid;
    gap: 16px;
}

.home-tabs__list {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 12px;
}

.home-tabs__trigger {
    background: var(--palette-hex-f8fafc);
    border: 1px solid var(--palette-hex-e2e8f0);
    border-radius: 14px;
    padding: 12px 16px;
    text-align: left;
    cursor: pointer;
    display: grid;
    gap: 4px;
    transition: border-color 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
    font-family: inherit;
}

.home-tabs__trigger.is-active,
.home-tabs__trigger:focus,
.home-tabs__trigger:hover {
    border-color: var(--palette-rgba-59-130-246-0-4);
    box-shadow: 0 10px 24px var(--palette-rgba-59-130-246-0-18);
    background: var(--palette-rgba-59-130-246-0-08);
    outline: none;
}

.home-tabs__title {
    font-weight: 700;
    color: var(--palette-hex-0f172a);
}

.home-tabs__hint {
    font-size: 0.85rem;
    color: var(--palette-hex-475569);
}

.home-tabs__panels {
    display: grid;
}

.home-tab-panel {
    border-radius: 14px;
    border: 1px dashed var(--palette-rgba-148-163-184-0-5);
    padding: 20px;
    background: var(--palette-rgba-241-245-249-0-4);
    display: grid;
    gap: 12px;
}

.home-tab-panel:not(.is-active) {
    display: none;
}

.home-hero {
    background: linear-gradient(135deg, var(--palette-rgba-59-130-246-0-15), var(--palette-rgba-45-212-191-0-15));
    border: 1px solid var(--palette-rgba-59-130-246-0-2);
    border-radius: 18px;
    padding: 36px;
    box-shadow: 0 22px 44px var(--palette-rgba-15-23-42-0-12);
}

.home-hero h1 {
    font-size: 2.2rem;
    margin-bottom: 12px;
}

.home-hero__lead {
    margin: 0;
    max-width: 720px;
    color: var(--palette-hex-334155);
    font-size: 1.05rem;
}

.home-hero__actions {
    margin-top: 24px;
    display: flex;
    gap: 16px;
    flex-wrap: wrap;
}

.home-sections {
    display: grid;
    gap: 20px;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
}

.home-card {
    background: var(--palette-hex-ffffff);
    border-radius: 18px;
    padding: 24px;
    box-shadow: 0 18px 32px var(--palette-rgba-15-23-42-0-08);
    border: 1px solid var(--palette-hex-e2e8f0);
    display: grid;
    gap: 12px;
}

.home-card h2 {
    display: flex;
    align-items: center;
    gap: 10px;
    margin: 0;
    font-size: 1.2rem;
}

.home-card__link {
    justify-self: start;
    font-weight: 600;
    color: var(--palette-hex-2563eb);
    text-decoration: none;
}

.home-card__link:hover {
    text-decoration: underline;
}

/* Results Table */
#results table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

#results th,
#results td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid var(--palette-hex-ddd);
}

#results th {
    background-color: var(--palette-hex-f0f0f0);
    font-weight: bold;
}

#results tbody tr:nth-child(odd) {
    background-color: var(--palette-hex-f9f9f9);
}

#results tbody tr:nth-child(even) {
    background-color: var(--palette-hex-ffffff);
}

#results tbody tr:hover {
    background-color: var(--palette-hex-eaeaea);
}

#results a {
    color: var(--palette-hex-3498db);
    text-decoration: none;
}

#results a:hover {
    text-decoration: underline;
}

/* Database info */
.database-info {
    display: grid;
    gap: 24px;
}

.database-info__table {
    width: 100%;
    border-collapse: collapse;
    background: var(--palette-hex-ffffff);
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 16px 32px var(--palette-rgba-15-23-42-0-08);
}

.database-info__table th,
.database-info__table td {
    padding: 16px;
    text-align: left;
    border-bottom: 1px solid var(--palette-hex-e2e8f0);
}

.database-info__table th {
    background: var(--palette-hex-0f172a);
    color: var(--palette-hex-f8fafc);
    font-weight: 600;
}

/* Historian Agent */
.historian-agent {
    display: grid;
    gap: 24px;
}

.agent-hero {
    background: linear-gradient(135deg, var(--palette-rgba-79-70-229-0-12), var(--palette-rgba-6-182-212-0-12));
    border: 1px solid var(--palette-rgba-79-70-229-0-25);
    border-radius: 18px;
    padding: 32px;
    position: relative;
    overflow: hidden;
}

.agent-hero::after {
    content: "";
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at top right, var(--palette-rgba-79-70-229-0-25), transparent 55%);
    pointer-events: none;
}

.agent-hero h1 {
    font-size: 2rem;
    margin-bottom: 8px;
    position: relative;
    z-index: 1;
}

.agent-hero__badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    border-radius: 999px;
    background: var(--palette-rgba-79-70-229-0-16);
    color: var(--palette-hex-4338ca);
    font-weight: 600;
    font-size: 0.85rem;
    letter-spacing: 0.02em;
    margin-bottom: 12px;
    position: relative;
    z-index: 1;
}

.agent-hero__subtitle {
    margin: 0;
    font-size: 1.05rem;
    color: var(--palette-hex-374151);
    max-width: 640px;
    position: relative;
    z-index: 1;
}

.agent-panel {
    display: grid;
    gap: 20px;
    padding: 24px;
    border-radius: 18px;
    background: linear-gradient(160deg, var(--palette-hex-ffffff) 0%, var(--palette-hex-f9fafb) 100%);
    box-shadow: 0 18px 32px var(--palette-rgba-15-23-42-0-08);
    border: 1px solid var(--palette-hex-e2e8f0);
}

.agent-panel.is-loading {
    opacity: 0.85;
    pointer-events: none;
}

.agent-panel--disabled {
    opacity: 0.6;
}


.agent-settings {
    background: var(--palette-hex-ffffff);
    border: 1px solid var(--palette-hex-e2e8f0);
    border-radius: 18px;
    padding: 24px;
    box-shadow: 0 16px 36px var(--palette-rgba-15-23-42-0-06);
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.agent-settings__header h2 {
    margin-bottom: 4px;
}

.agent-settings__header p {
    margin: 0;
    color: var(--palette-hex-4b5563);
    font-size: 0.95rem;
    line-height: 1.5;
}

.agent-settings-callout {
    background: var(--palette-hex-0f172a);
    color: var(--palette-hex-f8fafc);
    padding: 24px;
    border-radius: 18px;
    display: grid;
    gap: 12px;
    box-shadow: 0 18px 32px var(--palette-rgba-15-23-42-0-35);
}

.agent-settings-callout a.button {
    justify-self: start;
}

.agent-settings__form {
    display: flex;
    flex-direction: column;
    gap: 18px;
}

.agent-settings .form-field {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.agent-settings .form-field label {
    font-weight: 600;
    color: var(--palette-hex-1f2937);
}

.agent-settings .form-field input[type="text"],
.agent-settings .form-field input[type="number"],
.agent-settings .form-field input[type="password"],
.agent-settings .form-field select,
.agent-settings .form-field textarea {
    width: 100%;
    border: 1px solid var(--palette-hex-cbd5f5);
    border-radius: 12px;
    padding: 10px 14px;
    font-size: 0.95rem;
    background: var(--palette-hex-f8fafc);
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.agent-settings .form-field input:focus,
.agent-settings .form-field textarea:focus,
.agent-settings .form-field select:focus {
    outline: none;
    border-color: var(--palette-hex-6366f1);
    box-shadow: 0 0 0 3px var(--palette-rgba-99-102-241-0-15);
    background: var(--palette-hex-ffffff);
}

.agent-settings .form-field__hint {
    margin: 0;
    font-size: 0.85rem;
    color: var(--palette-hex-64748b);
}

.agent-settings .form-field--grid {
    display: grid;
    gap: 16px;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
}

.agent-settings .form-field--toggle label {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
}

.agent-settings .form-field--toggle input[type="checkbox"] {
    width: auto;
}

.agent-settings__actions {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    justify-content: flex-end;
}

.agent-config-status {
    padding: 12px 14px;
    border-radius: 12px;
    font-size: 0.9rem;
    border: 1px solid transparent;
}

.agent-config-status[data-status="progress"] {
    background: var(--palette-rgba-79-70-229-0-08);
    border-color: var(--palette-rgba-79-70-229-0-2);
    color: var(--palette-hex-4338ca);
}

.agent-config-status[data-status="success"] {
    background: var(--palette-rgba-16-185-129-0-1);
    border-color: var(--palette-rgba-16-185-129-0-25);
    color: var(--palette-hex-047857);
}

.agent-config-status[data-status="error"] {
    background: var(--palette-rgba-239-68-68-0-12);
    border-color: var(--palette-rgba-239-68-68-0-25);
    color: var(--palette-hex-b91c1c);
}

.agent-config-status[data-status="info"] {
    background: var(--palette-rgba-59-130-246-0-1);
    border-color: var(--palette-rgba-59-130-246-0-2);
    color: var(--palette-hex-1d4ed8);
}

.agent-provider {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.agent-alert {
    padding: 18px 20px;
    border-radius: 14px;
    background-color: var(--palette-hex-f3f4f6);
    color: var(--palette-hex-1f2937);
    border: 1px solid var(--palette-hex-e5e7eb);
}

.agent-alert--error {
    background-color: var(--palette-hex-fee2e2);
    border-color: var(--palette-hex-fecaca);
    color: var(--palette-hex-991b1b);
}

.agent-history {
    border-radius: 16px;
    padding: 20px;
    max-height: 440px;
    overflow-y: auto;
    background: var(--palette-hex-ffffff);
    box-shadow: inset 0 0 0 1px var(--palette-hex-e5e7eb);
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.agent-history:empty::before {
    content: "Start the conversation by asking a question about the archives.";
    color: var(--palette-hex-94a3b8);
    text-align: center;
    padding: 40px 24px;
}

.agent-message {
    display: flex;
    gap: 12px;
    align-items: flex-start;
    animation: agentMessageIn 0.3s ease;
}

@keyframes agentMessageIn {
    from { opacity: 0; transform: translateY(6px); }
    to { opacity: 1; transform: translateY(0); }
}

.agent-message__avatar {
    width: 40px;
    height: 40px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 0.95rem;
    background: var(--palette-hex-e0e7ff);
    color: var(--palette-hex-3730a3);
}

.agent-message--user .agent-message__avatar {
    background: var(--palette-hex-fef3c7);
    color: var(--palette-hex-b45309);
}

/* Kept bubble/body selectors together so legacy and current message markup render identically. */
.agent-message__body,
.agent-message__bubble {
    background: var(--palette-hex-f9fafb);
    border-radius: 16px;
    padding: 12px 16px;
    border: 1px solid var(--palette-hex-e2e8f0);
    flex: 1;
}

.agent-message--assistant .agent-message__body,
.agent-message--assistant .agent-message__bubble {
    background: var(--palette-hex-eef2ff);
    border-color: var(--palette-rgba-79-70-229-0-45);
}

/* Keep assistant citations/footnotes stacked under the claim content. */
.agent-message--assistant {
    flex-direction: column;
    align-items: stretch;
}

.agent-message__role {
    font-weight: 600;
    margin-bottom: 6px;
    color: var(--palette-hex-1f2937);
}

.agent-message__content {
    white-space: pre-wrap;
    color: var(--palette-hex-334155);
    line-height: 1.55;
}

.agent-form textarea {
    width: 100%;
    resize: vertical;
    border-radius: 14px;
    padding: 14px 16px;
    border: 1px solid var(--palette-hex-cbd5f5);
    background: var(--palette-hex-ffffff);
    min-height: 120px;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
    font-size: 1rem;
}

.agent-form textarea:focus {
    outline: none;
    border-color: var(--palette-hex-6366f1);
    box-shadow: 0 0 0 4px var(--palette-rgba-99-102-241-0-15);
}

.agent-refinement-toggle {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    margin-top: 12px;
    color: var(--palette-hex-334155);
    font-size: 0.9rem;
    cursor: pointer;
}

.agent-refinement-toggle input[type="checkbox"] {
    margin: 0;
}

.agent-suggestions {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 12px;
}

.agent-suggestion {
    border: 1px solid var(--palette-hex-dbeafe);
    background: var(--palette-hex-eff6ff);
    border-radius: 999px;
    padding: 8px 14px;
    font-size: 0.9rem;
    color: var(--palette-hex-1d4ed8);
    cursor: pointer;
    transition: background 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
}

.agent-suggestion:hover {
    background: var(--palette-hex-dbeafe);
    transform: translateY(-1px);
    box-shadow: 0 10px 18px var(--palette-rgba-59-130-246-0-15);
}

.agent-actions {
    display: flex;
    gap: 12px;
    justify-content: flex-end;
    align-items: center;
    margin-top: 12px;
    flex-wrap: wrap;
}

.agent-refinement-modal {
    position: fixed;
    inset: 0;
    z-index: 2500;
    background: rgba(15, 23, 42, 0.55);
    align-items: center;
    justify-content: center;
    padding: 16px;
}

.agent-refinement-modal__inner {
    width: min(640px, 100%);
    background: var(--palette-hex-ffffff);
    border: 1px solid var(--palette-hex-e2e8f0);
    border-radius: 16px;
    box-shadow: 0 24px 48px rgba(15, 23, 42, 0.2);
    padding: 20px;
    display: grid;
    gap: 14px;
}

.agent-refinement-modal__inner h2 {
    margin: 0;
    font-size: 1.15rem;
    color: var(--palette-hex-0f172a);
}

.agent-refinement-modal__inner p {
    margin: 0;
    color: var(--palette-hex-475569);
    line-height: 1.45;
}

.agent-refinement-suggestions {
    display: grid;
    gap: 8px;
}

.agent-refinement-tip {
    margin: 0;
    border: 1px solid var(--palette-hex-dbeafe);
    background: var(--palette-hex-eff6ff);
    border-radius: 10px;
    padding: 10px 12px;
    color: var(--palette-hex-1e3a8a);
    font-size: 0.9rem;
    line-height: 1.4;
}

.agent-refinement-modal__actions {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    flex-wrap: wrap;
}

.agent-status {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 6px 12px;
    border-radius: 999px;
    background: var(--palette-rgba-79-70-229-0-1);
    color: var(--palette-hex-4338ca);
    font-weight: 600;
    font-size: 0.9rem;
}

.agent-status__dot {
    width: 8px;
    height: 8px;
    border-radius: 999px;
    background: currentColor;
    position: relative;
    animation: agentStatusPulse 1.2s ease-in-out infinite;
}

@keyframes agentStatusPulse {
    0%, 100% { opacity: 0.4; transform: scale(0.85); }
    50% { opacity: 1; transform: scale(1); }
}

.data-files {
    max-width: 960px;
    margin: 2rem auto 3rem;
    display: grid;
    gap: 2rem;
}

.data-files__intro h1 {
    font-size: 2rem;
    margin-bottom: 0.5rem;
}

.data-files__intro p {
    color: var(--palette-hex-4b5563);
    line-height: 1.5;
}

.data-files__panel {
    background: var(--palette-hex-ffffff);
    border-radius: 12px;
    padding: 1.75rem;
    box-shadow: 0 12px 32px var(--palette-rgba-15-23-42-0-06);
}

.data-files__panel h2 {
    margin-top: 0;
    font-size: 1.25rem;
    margin-bottom: 1rem;
}

.data-files__download {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.25rem;
    flex-wrap: wrap;
}

.data-files__download-link {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    background: linear-gradient(135deg, var(--palette-hex-2563eb), var(--palette-hex-1d4ed8));
    color: var(--palette-hex-ffffff);
    padding: 0.65rem 1.3rem;
    border-radius: 999px;
    text-decoration: none;
    font-weight: 600;
    box-shadow: 0 12px 24px var(--palette-rgba-37-99-235-0-25);
    transition: transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
}

.data-files__download-link:hover {
    transform: translateY(-1px);
    box-shadow: 0 16px 32px var(--palette-rgba-29-78-216-0-3);
    filter: brightness(1.05);
}

.data-files__hint {
    margin: 0;
    color: var(--palette-hex-4b5563);
    font-size: 0.9rem;
}

.data-files__form {
    display: grid;
    gap: 1.5rem;
}

.data-files__form button[type="submit"] {
    justify-self: start;
}

.data-files__list {
    list-style: none;
    margin: 0;
    padding: 0;
    display: grid;
    gap: 0.5rem;
    max-height: 320px;
    overflow-y: auto;
}

.data-files__list li {
    padding: 0.5rem 0.75rem;
    background: var(--palette-hex-f1f5f9);
    border-radius: 8px;
    font-family: 'Fira Code', Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;
    font-size: 0.9rem;
    color: var(--palette-hex-1f2937);
    word-break: break-all;
}

.data-files__note {
    margin-top: 1rem;
    color: var(--palette-hex-4b5563);
    font-size: 0.9rem;
}

@media (max-width: 768px) {
    .data-files {
        margin: 1.5rem 1rem 2.5rem;
    }

    .data-files__panel {
        padding: 1.25rem;
    }

    .search-field {
        flex-direction: column;
        align-items: stretch;
    }

    .primary-nav__list {
        flex-wrap: wrap;
        justify-content: flex-end;
    }
}

@media (max-width: 768px) {
    .agent-panel {
        padding: 18px;
    }

    .agent-history {
        max-height: 360px;
    }

    .agent-hero {
        padding: 24px;
    }
}

/* Document Detail Page Styles */
.document-detail .detail-container {
    display: flex;
    gap: 0; /* Remove the gap since the resizer acts as the gap */
    width: 100%;
}

.document-detail .info-panel {
    flex: 0 0 60%; /* Initial width: 60% */
    overflow-y: auto;
    overflow-x: hidden;
    max-height: calc(100vh - 136px); /* Account for fixed header so panel content stays fully in viewport. */
    min-width: 0;
}

.document-detail .image-panel {
    flex: 0 0 40%; /* Initial width: 40% */
    min-width: 0;
    display: flex; /* Keep the viewer controls docked while the image area scrolls. */
    flex-direction: column;
    height: calc(100vh - 136px); /* Match effective viewport below header to avoid clipped controls. */
    position: sticky;
    top: 12px; /* Keep a small visual gutter from the top while sticky. */
}

/* Resizer Styles */
.resizer {
    width: 5px;
    background-color: var(--color-border);
    cursor: col-resize;
    position: relative;
    transition: background var(--transition);
}

.resizer:hover {
    background-color: var(--color-primary);
}

/* Ensure the panels and resizer fill the container */
.info-panel,
.image-panel,
.resizer {
    flex-shrink: 0;
}

/* Information Sections */
.document-detail .info-section {
    margin-bottom: 16px;
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: 16px;
    background: var(--color-bg);
}

/* Tables */
.info-table,
.nested-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 10px;
}

.info-table th,
.nested-table th {
    text-align: left;
    padding: 10px 12px;
    background-color: var(--color-surface);
    border-bottom: 1px solid var(--color-border);
    width: 30%;
    vertical-align: top;
    font-weight: 600;
    color: var(--color-text);
    font-size: 0.88rem;
}

.info-table td,
.nested-table td {
    padding: 10px 12px;
    border-bottom: 1px solid var(--color-border);
    color: var(--color-text);
}

.info-table.nested th {
    padding-left: 20px;
    background-color: var(--color-surface-alt);
}

/* Ensure tables inside info-panel don't exceed container width */
.info-panel table {
    table-layout: fixed;
    width: 100%;
}

.info-panel th,
.info-panel td {
    word-wrap: break-word;
    /* Alternatively, you can use */
    /* word-break: break-all; */
}

/* Linked Information */
.linked-information {
    margin-top: 10px;
    padding-left: 10px;
    border-left: 2px solid var(--color-border-strong);
}

.linked-section {
    margin-bottom: 10px;
}

.linked-section h5 {
    margin-bottom: 5px;
}

/* Lists within Tables */
.info-table ul,
.nested-list,
.info-list {
    list-style-type: disc;
    margin-left: 40px;
    padding-left: 0;
}

.info-table ul li,
.nested-list li,
.info-list li {
    margin-bottom: 10px;
}

/* Nested Blocks */
.nested-block {
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    padding: 12px;
    border-radius: var(--radius-sm);
    margin-top: 10px;
}

.nested-item {
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    padding: 8px 10px;
    border-radius: var(--radius-sm);
    margin-bottom: 6px;
    color: var(--color-text);
}

.nested-item:nth-child(even) {
    background-color: var(--color-surface);
}

.nested-item:nth-child(odd) {
    background-color: var(--color-surface);
}

/* Extracted Entities Section */
.entity-group {
    margin-bottom: 15px;
}

.entity-group h3 {
    text-transform: uppercase;
    font-size: 0.75rem;
    letter-spacing: 0.06em;
    color: var(--color-text-muted);
    margin-bottom: 6px;
    /* Reuse heading token so metadata headers match the new typographic system. */
    font-family: var(--font-heading);
}

.entity-group ul {
    list-style-type: disc;
    margin-left: 20px;
    padding-left: 0;
}

.entity-group li {
    padding: 3px 0;
    color: var(--color-text);
}

/* Image Container */
#imageContainer {
    flex: 1; /* Fill the remaining panel space above control rows. */
    overflow: auto;
    cursor: grab;
    position: relative;
    min-height: 0; /* Allow flexbox shrinking so controls are not pushed off-screen. */
}

#imageContainer.active {
    cursor: grabbing;
}

#documentImage {
    display: block;
    transform-origin: center;
}

/* Image Styles */
#documentImage {
    display: block;
    width: 100%; /* Make the image take the full width of its container */
    height: auto; /* Maintain aspect ratio */
    transform-origin: center;
}


/* Zoom and Adjustment Controls */
.zoom-controls,
.adjustment-controls {
    flex-shrink: 0; /* Prevent controls from collapsing out of the viewport. */
    margin-top: 6px;
}

.zoom-controls button,
.adjustment-controls button {
    padding: 8px 12px;
    font-size: 14px;
}

.adjustment-controls {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 10px;
    align-items: center;
    max-height: 42vh; /* Keep long control stacks reachable without page scroll. */
    overflow-y: auto;
    padding-right: 4px; /* Reserve room for scrollbar so labels/sliders remain readable. */
}

.adjustment-controls .control-group {
    display: flex;
    align-items: center;
}

.adjustment-controls .control-group label {
    flex: 1;
    margin-right: 10px;
}

.adjustment-controls .control-group input[type="range"] {
    flex: 2;
}

.adjustment-controls .buttons-group {
    grid-column: span 2;
    display: flex;
    flex-wrap: wrap;
    gap: 5px;
}

/* Optional: Style for better tooltip visibility */
input[type="range"] {
    position: relative;
}

/* Loading Indicator and Spinner */
.loading-indicator,
#loadingIndicator {
    text-align: center;
    margin-top: 20px;
    display: none;
}

.spinner {
    border: 4px solid var(--palette-hex-f3f3f3);
    border-top: 4px solid var(--palette-hex-3498db);
    border-radius: 50%;
    width: 40px;
    height: 40px;
    animation: spin 1s linear infinite;
    margin: 0 auto;
}

@keyframes spin {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(360deg);
    }
}

/* Messages and Errors */
.flashes {
    list-style-type: none;
    padding: 0;
    color: red;
}

.error {
    color: var(--palette-hex-dc3545);
    font-weight: bold;
}

#noDataMessage {
    display: none;
    color: red;
    margin-top: 20px;
    font-weight: bold;
    text-align: center;
}

/* Sections and Pagination */
.section {
    margin-top: 30px;
}

.pagination-controls {
    margin-top: 20px;
    text-align: center;
}

.pagination-controls button {
    padding: 10px 20px;
    margin: 0 5px;
    font-size: 16px;
    cursor: pointer;
    border: none;
    background-color: var(--palette-hex-3498db);
    color: white;
    border-radius: 5px;
}

.pagination-controls button:disabled {
    background-color: var(--palette-hex-95a5a6);
    cursor: not-allowed;
}

/* Utility Classes */
.mt-4 {
    margin-top: 1rem;
}

.ml-auto {
    margin-left: auto;
}
.settings-page {
    display: grid;
    gap: 32px;
}

.settings-section {
    background: var(--palette-hex-ffffff);
    border-radius: 18px;
    padding: 28px;
    box-shadow: 0 18px 36px var(--palette-rgba-15-23-42-0-08);
    border: 1px solid var(--palette-hex-e2e8f0);
    display: grid;
    gap: 20px;
}

.settings-section__header h2 {
    margin: 0 0 4px;
}

.settings-section__header p {
    margin: 0;
    color: var(--palette-hex-4b5563);
}

.settings-form {
    display: grid;
    gap: 20px;
}

.settings-grid {
    display: grid;
    gap: 20px;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
}

.settings-group {
    display: grid;
    gap: 10px;
}

.settings-group h3 {
    margin-bottom: 4px;
}

.settings-directory-picker {
    display: flex;
    gap: 12px;
    align-items: center;
}

.settings-directory-picker input[type="text"] {
    flex: 1;
    min-width: 0;
}

.build-meta {
    margin: 0;
    display: grid;
    gap: 12px;
}

.build-meta > div {
    display: grid;
    gap: 4px;
    padding: 10px 12px;
    border: 1px solid var(--palette-hex-e5e7eb);
    border-radius: 10px;
    background: var(--palette-hex-f8fafc);
}

.build-meta dt {
    font-size: 0.85rem;
    color: var(--palette-hex-475569);
    font-weight: 600;
}

.build-meta dd {
    margin: 0;
    color: var(--palette-hex-0f172a);
    word-break: break-word;
}

.form-field__hint--selection {
    color: var(--color-text-muted, var(--palette-hex-4b5563));
}
.help-page {
    display: grid;
    gap: 32px;
}

.help-intro {
    max-width: 760px;
    color: var(--palette-hex-475569);
}

.help-section {
    background: var(--palette-hex-ffffff);
    border-radius: 18px;
    padding: 28px;
    box-shadow: 0 16px 32px var(--palette-rgba-15-23-42-0-08);
    border: 1px solid var(--palette-hex-e2e8f0);
    display: grid;
    gap: 16px;
}

.help-section table {
    width: 100%;
    border-collapse: collapse;
    border-radius: 12px;
    overflow: hidden;
}

.help-section th,
.help-section td {
    padding: 14px 16px;
    border-bottom: 1px solid var(--palette-hex-e2e8f0);
    text-align: left;
}

.help-section th {
    background: var(--palette-hex-0f172a);
    color: var(--palette-hex-f8fafc);
}

/* Error page */
.error-page {
    display: grid;
    justify-items: center;
    gap: 16px;
    padding: 80px 20px;
    text-align: center;
}

.error-page h1 {
    margin: 0;
}

.error-page p {
    margin: 0;
    max-width: 640px;
    color: var(--palette-hex-475569);
    font-size: 1.05rem;
}

.error-page .button {
    margin-top: 12px;
}

.ingestion-status {
    margin-top: 1rem;
    padding: 0.75rem 1rem;
    border-radius: 4px;
    background: var(--color-surface-muted, var(--palette-hex-f2f4f8));
    color: inherit;
}

.ingestion-status[data-status-type="success"] {
    background: var(--color-success-muted, var(--palette-hex-e6f4ea));
    color: var(--color-success, var(--palette-hex-10793f));
}

.ingestion-status[data-status-type="error"] {
    background: var(--color-danger-muted, var(--palette-hex-fdecea));
    color: var(--color-danger, var(--palette-hex-b00020));
}

.ingestion-summary {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 0.5rem 1rem;
    margin: 1rem 0;
}

.ingestion-summary dt {
    font-weight: 600;
}

.ingestion-summary dd {
    margin: 0;
    color: var(--color-text-muted, var(--palette-hex-555));
}

.ingestion-errors {
    margin-top: 0.5rem;
}

.ingestion-errors ul {
    margin: 0;
    padding-left: 1.25rem;
}

.ingestion-errors li {
    margin: 0.25rem 0;
    word-break: break-word;
}

.settings-ingestion__automation .button--secondary {
    margin-top: 0.5rem;
}


/* Historian Agent method selector + activity stream + inline metrics refresh. */
.agent-method-selector {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 14px 18px;
    background: var(--color-surface);
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    flex-wrap: wrap;
}

.agent-method-selector label {
    font-weight: 600;
    color: var(--color-text);
    white-space: nowrap;
}

.agent-method-selector select {
    flex: 0 1 auto;
    min-width: 220px;
    padding: 8px 12px;
    border: 1px solid var(--color-border-strong);
    border-radius: var(--radius-sm);
    background: var(--color-bg);
    font-size: 0.95rem;
    cursor: pointer;
    transition: border-color var(--transition), box-shadow var(--transition);
}

.agent-method-selector select:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 3px var(--color-primary-muted);
}

.agent-method-hint {
    flex: 1 1 auto;
    font-size: 0.85rem;
    color: var(--color-text-muted);
    font-style: italic;
}

/* Activity stream replaces the always-open terminal look and still reuses existing log entry styles. */
.agent-activity {
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    background: var(--color-surface);
    overflow: hidden;
}

.agent-activity__header {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 14px;
    min-height: 42px;
}

.agent-activity__indicator {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    flex-shrink: 0;
    background: var(--color-border-strong);
    transition: background var(--transition);
}

.agent-activity__indicator.is-running {
    background: var(--color-primary);
    animation: pulse-dot 1.2s ease-in-out infinite;
}

.agent-activity__indicator.is-idle {
    background: var(--color-success);
}

@keyframes pulse-dot {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.5; transform: scale(0.75); }
}

.agent-activity__label {
    font-size: 0.82rem;
    font-weight: 600;
    color: var(--color-text-muted);
    flex: 1;
    /* Reuse heading token for compact status labels. */
    font-family: var(--font-heading);
    letter-spacing: 0.02em;
    text-transform: uppercase;
}

.agent-activity__toggle,
.agent-activity__clear {
    padding: 3px 10px;
    font-size: 0.75rem;
    font-weight: 600;
    border: 1px solid var(--color-border);
    border-radius: var(--radius-pill);
    background: var(--color-bg);
    color: var(--color-text-muted);
    cursor: pointer;
    transition: background var(--transition), border-color var(--transition), color var(--transition);
}

.agent-activity__toggle:hover,
.agent-activity__clear:hover {
    background: var(--color-surface-alt);
    border-color: var(--color-border-strong);
    color: var(--color-text);
}

.agent-debug-output {
    padding: 12px 14px;
    max-height: 220px;
    overflow-y: auto;
    color: var(--palette-hex-e2e8f0);
    line-height: 1.6;
    background: var(--palette-hex-0f172a);
    border-top: 1px solid var(--color-border);
    font-family: 'Fira Code', 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
    font-size: 0.85rem;
}

.agent-debug-output:empty::before {
    content: "Backend log is empty. Start a run to see backend events.";
    color: var(--palette-hex-64748b);
    font-style: italic;
}

.agent-debug-entry {
    display: flex;
    gap: 10px;
    margin-bottom: 4px;
    padding: 2px 0;
}

.agent-debug-time {
    color: var(--palette-hex-64748b);
    flex-shrink: 0;
    font-weight: 600;
}

.agent-debug-message {
    color: var(--palette-hex-e2e8f0);
    word-break: break-word;
}

.agent-debug-entry--primary .agent-debug-message {
    color: var(--palette-hex-60a5fa);
    font-weight: 700;
}

.agent-debug-entry--success .agent-debug-message {
    color: var(--palette-hex-34d399);
}

.agent-debug-entry--warning .agent-debug-message {
    color: var(--palette-hex-fbbf24);
}

.agent-debug-entry--error .agent-debug-message {
    color: var(--palette-hex-f87171);
    font-weight: 600;
}

.agent-debug-entry--info .agent-debug-message {
    color: var(--palette-hex-cbd5e1);
}

.agent-debug-entry--debug .agent-debug-message {
    color: var(--palette-hex-64748b);
}

/* Added per-answer inline metrics so confidence and runtime are visible in-context. */
.agent-metrics-bar {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-top: 10px;
    padding-top: 10px;
    border-top: 1px solid var(--color-border);
}

.metric-pill {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    padding: 3px 10px;
    border-radius: var(--radius-pill);
    font-size: 0.78rem;
    font-weight: 600;
    /* Reuse body token for compact metric text. */
    font-family: var(--font-body);
}

.metric-pill i {
    font-size: 0.72rem;
}

.metric-pill--good {
    background: var(--color-success-muted);
    color: var(--color-success);
}

.metric-pill--warn {
    background: var(--color-warn-muted);
    color: var(--color-warn);
}

.metric-pill--low {
    background: var(--color-danger-muted);
    color: var(--color-danger);
}

.metric-pill--neutral {
    background: var(--color-surface-alt);
    color: var(--color-text-muted);
}

@media (max-width: 768px) {
    .agent-method-selector {
        flex-direction: column;
        align-items: stretch;
    }

    .agent-method-selector select {
        width: 100%;
    }

    .agent-method-hint {
        text-align: center;
    }

    .agent-activity__header {
        flex-wrap: wrap;
    }

    .agent-debug-output {
        font-size: 0.75rem;
        max-height: 200px;
    }
}

.agent-debug-output::-webkit-scrollbar {
    width: 8px;
}

.agent-debug-output::-webkit-scrollbar-track {
    background: var(--palette-hex-1e293b);
    border-radius: 4px;
}

.agent-debug-output::-webkit-scrollbar-thumb {
    background: var(--palette-hex-475569);
    border-radius: 4px;
}

.agent-debug-output::-webkit-scrollbar-thumb:hover {
    background: var(--palette-hex-64748b);
}


/* Markdown formatting in agent messages */
.agent-message__bubble h1,
.agent-message__bubble h2,
.agent-message__bubble h3 {
    margin-top: 16px;
    margin-bottom: 8px;
    font-weight: 700;
}

.agent-message__bubble h1 { font-size: 1.3rem; }
.agent-message__bubble h2 { font-size: 1.15rem; }
.agent-message__bubble h3 { font-size: 1.05rem; }

.agent-message__bubble ul,
.agent-message__bubble ol {
    margin: 12px 0;
    padding-left: 24px;
}

.agent-message__bubble li {
    margin: 6px 0;
}

.agent-message__bubble strong {
    font-weight: 700;
    color: var(--palette-hex-1f2937);
}

.agent-message__bubble code {
    background: var(--palette-hex-f1f5f9);
    padding: 2px 6px;
    border-radius: 4px;
    font-family: 'Fira Code', monospace;
    font-size: 0.9em;
}

.agent-message__bubble pre {
    background: var(--palette-hex-1e293b);
    color: var(--palette-hex-e2e8f0);
    padding: 12px;
    border-radius: 8px;
    overflow-x: auto;
    margin: 12px 0;
}

.agent-message__bubble pre code {
    background: none;
    padding: 0;
    color: inherit;
}

.agent-message__bubble p {
    margin: 8px 0;
}

/* 
   CORPUS EXPLORER
 */

.corpus-explorer {
    display: grid;
    gap: 24px;
}

.corpus-explorer__hero {
    background: linear-gradient(135deg, var(--palette-rgba-16-185-129-0-10), var(--palette-rgba-6-182-212-0-10));
    border-color: var(--palette-rgba-16-185-129-0-25);
}

/*  Notebooks bar  */
.ce-notebooks {
    background: var(--palette-hex-ffffff);
    border: 1px solid var(--palette-hex-e2e8f0);
    border-radius: 14px;
    padding: 18px 20px;
}

.ce-notebooks__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 12px;
}

.ce-notebooks__header h2 { margin: 0; font-size: 1rem; color: var(--palette-hex-374151); }

.ce-notebooks__list {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.ce-notebooks__empty { margin: 0; color: var(--palette-hex-94a3b8); font-size: 0.9rem; }

.ce-notebook-item {
    display: flex;
    flex-direction: column;
    gap: 2px;
    padding: 8px 12px;
    background: var(--palette-hex-f8fafc);
    border: 1px solid var(--palette-hex-e2e8f0);
    border-radius: 8px;
    cursor: pointer;
    text-align: left;
    transition: border-color 0.15s, background 0.15s;
}

.ce-notebook-item:hover { background: var(--palette-hex-eff6ff); border-color: var(--palette-hex-93c5fd); }
.ce-notebook-item__name { font-weight: 600; color: var(--palette-hex-1e3a8a); font-family: monospace; font-size: 0.8rem; }
.ce-notebook-item__meta { color: var(--palette-hex-64748b); font-size: 0.78rem; }

/*  Form panel  */
.ce-form-panel__header { margin-bottom: 4px; }
.ce-form-panel__header h2 { margin-bottom: 4px; }
.ce-form-panel__header p { margin: 0; color: var(--palette-hex-64748b); }

.ce-form { display: grid; gap: 24px; }

.ce-form__field { display: grid; gap: 8px; }

.ce-form__field label {
    font-weight: 600;
    color: var(--palette-hex-1f2937);
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.ce-form__hint { font-weight: 400; color: var(--palette-hex-64748b); font-size: 0.88rem; }

.ce-form__field textarea,
.ce-form__field input[type="number"] {
    border: 1px solid var(--palette-hex-cbd5e1);
    border-radius: 10px;
    padding: 10px 14px;
    font-size: 0.95rem;
    background: var(--palette-hex-f8fafc);
    font-family: inherit;
    transition: border-color 0.2s;
    width: 100%;
    box-sizing: border-box;
}

.ce-form__field textarea:focus,
.ce-form__field input:focus {
    outline: none;
    border-color: var(--palette-hex-6366f1);
    box-shadow: 0 0 0 3px var(--palette-rgba-99-102-241-0-1);
}

.ce-form__field--inline label { flex-direction: row; align-items: center; gap: 12px; }

.ce-year-range { display: flex; align-items: center; gap: 8px; }
.ce-year-range input { width: 100px; }

.ce-strategy-grid {
    display: grid;
    gap: 10px;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
}

.ce-strategy-card {
    display: grid;
    gap: 6px;
    padding: 14px 16px;
    border: 2px solid var(--palette-hex-e2e8f0);
    border-radius: 12px;
    cursor: pointer;
    transition: border-color 0.15s, background 0.15s;
    font-size: 0.9rem;
}

.ce-strategy-card input { display: none; }
.ce-strategy-card strong { font-size: 0.95rem; color: var(--palette-hex-1f2937); }
.ce-strategy-card span { color: var(--palette-hex-64748b); font-size: 0.85rem; line-height: 1.4; }
.ce-strategy-card:hover { border-color: var(--palette-hex-a5b4fc); background: var(--palette-hex-f5f3ff); }
.ce-strategy-card--selected { border-color: var(--palette-hex-6366f1); background: var(--palette-hex-f5f3ff); }

.ce-scope-options {
    display: grid;
    gap: 10px;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
}

.ce-scope-card {
    display: grid;
    gap: 4px;
    padding: 14px 16px;
    border: 2px solid var(--palette-hex-e2e8f0);
    border-radius: 12px;
    cursor: pointer;
    transition: border-color 0.15s, background 0.15s;
    font-size: 0.88rem;
}

.ce-scope-card input { display: none; }
.ce-scope-card strong { font-size: 0.92rem; color: var(--palette-hex-1f2937); }
.ce-scope-card span:nth-child(3) { color: var(--palette-hex-475569); font-weight: 500; }
.ce-scope-card__use { color: var(--palette-hex-94a3b8); font-size: 0.82rem; }
.ce-scope-card:hover { border-color: var(--palette-hex-a5b4fc); background: var(--palette-hex-f5f3ff); }
.ce-scope-card--selected { border-color: var(--palette-hex-6366f1); background: var(--palette-hex-f5f3ff); }

.ce-form__actions { display: flex; align-items: center; gap: 16px; flex-wrap: wrap; }
.ce-form__estimate { color: var(--palette-hex-64748b); font-size: 0.9rem; }

/*  Running panel  */
.ce-running__header { display: flex; align-items: center; justify-content: space-between; }
.ce-running__elapsed { font-family: monospace; font-size: 1.1rem; color: var(--palette-hex-374151); font-weight: 600; }
.ce-running__note { margin: 0; color: var(--palette-hex-64748b); font-size: 0.9rem; }

/*  Results  */
.ce-results { display: grid; gap: 20px; }
.ce-results__toolbar { display: flex; gap: 12px; flex-wrap: wrap; }

.ce-section {
    background: var(--palette-hex-ffffff);
    border: 1px solid var(--palette-hex-e2e8f0);
    border-radius: 16px;
    padding: 24px;
    box-shadow: 0 8px 20px var(--palette-rgba-15-23-42-0-05);
}

.ce-section__title { margin: 0 0 6px; font-size: 1.2rem; }
.ce-section__subtitle { margin: 0 0 16px; color: var(--palette-hex-64748b); font-size: 0.92rem; }

.ce-stats-grid { display: flex; flex-wrap: wrap; gap: 16px; margin-bottom: 16px; }

.ce-stat {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 12px 20px;
    background: var(--palette-hex-f8fafc);
    border-radius: 12px;
    border: 1px solid var(--palette-hex-e2e8f0);
    min-width: 100px;
    text-align: center;
}

.ce-stat__value { font-size: 1.5rem; font-weight: 700; color: var(--palette-hex-1e3a8a); }
.ce-stat__label { font-size: 0.8rem; color: var(--palette-hex-64748b); margin-top: 2px; }
.ce-archive-notes p { margin: 0; color: var(--palette-hex-374151); line-height: 1.7; font-size: 0.95rem; }

/* Grand narrative */
.ce-grand-narrative { background: linear-gradient(135deg, var(--palette-hex-0f172a), var(--palette-hex-1e3a5f)); color: var(--palette-hex-f8fafc); border: none; }
.ce-grand-narrative__label {
    display: inline-block;
    font-size: 0.78rem;
    font-weight: 700;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--palette-hex-7dd3fc);
    margin-bottom: 10px;
}
.ce-grand-narrative__question {
    margin: 0 0 14px;
    font-size: 1.25rem;
    font-style: italic;
    line-height: 1.5;
    border-left: 3px solid var(--palette-hex-38bdf8);
    padding-left: 16px;
    color: var(--palette-hex-f0f9ff);
}
.ce-grand-narrative__themes { display: flex; flex-wrap: wrap; gap: 8px; }

/* Themes */
.ce-themes { display: grid; gap: 20px; }

.ce-theme { border: 1px solid var(--palette-hex-e2e8f0); border-radius: 14px; overflow: hidden; }
.ce-theme__header { padding: 14px 18px; background: var(--palette-hex-f8fafc); border-bottom: 1px solid var(--palette-hex-e2e8f0); }
.ce-theme__name { margin: 0 0 4px; font-size: 1rem; }
.ce-theme__desc { margin: 0; color: var(--palette-hex-64748b); font-size: 0.88rem; }
.ce-theme__questions { padding: 12px; display: grid; gap: 10px; }

/* Question cards */
.ce-question-card {
    padding: 14px 16px;
    background: var(--palette-hex-ffffff);
    border: 1px solid var(--palette-hex-e2e8f0);
    border-radius: 10px;
    display: grid;
    gap: 8px;
}
.ce-question-card__meta { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
.ce-question-card__text { margin: 0; color: var(--palette-hex-1f2937); font-size: 0.95rem; line-height: 1.5; }
.ce-question-card__investigate { justify-self: start; font-size: 0.82rem; padding: 5px 12px; text-decoration: none; }

/* Gaps */
.ce-gaps-section .ce-section__title { color: var(--palette-hex-92400e); }
.ce-gaps { display: grid; gap: 14px; }

.ce-gap-card {
    padding: 14px 16px;
    background: var(--palette-hex-fffbeb);
    border: 1px solid var(--palette-hex-fde68a);
    border-radius: 10px;
}

/* 
   Historian UX additions (entity popover, footnotes, search filters, etc.)
 */

/* Entity item affordance */
.entity-item[data-entity-id] {
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 6px;
    border-radius: var(--radius-sm);
    padding: 2px 6px;
    margin: 1px -6px;
    transition: background var(--transition);
}

.entity-item[data-entity-id]:hover,
.entity-item[data-entity-id]:focus {
    background: var(--color-primary-muted);
    outline: none;
}

.entity-item__hint {
    font-size: 0.7rem;
    color: var(--color-text-subtle);
    opacity: 0;
    transition: opacity var(--transition);
}

.entity-item[data-entity-id]:hover .entity-item__hint,
.entity-item[data-entity-id]:focus .entity-item__hint {
    opacity: 1;
}

/* Historian entity popover */
.entity-popover {
    position: absolute;
    z-index: 200;
    width: 280px;
    background: var(--color-bg);
    border: 1px solid var(--color-border-strong);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-lg);
    overflow: hidden;
    animation: popover-in 0.15s ease;
}

@keyframes popover-in {
    from { opacity: 0; transform: translateY(-4px); }
    to { opacity: 1; transform: translateY(0); }
}

.entity-popover__header {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 12px;
    background: var(--color-surface);
    border-bottom: 1px solid var(--color-border);
}

.entity-popover__type {
    font-size: 0.68rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: var(--color-text-muted);
    font-family: 'Montserrat', sans-serif;
}

.entity-popover__name {
    font-weight: 600;
    color: var(--color-text);
    font-size: 0.9rem;
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.entity-popover__close {
    background: none;
    border: none;
    color: var(--color-text-muted);
    cursor: pointer;
    font-size: 1.1rem;
    line-height: 1;
    padding: 0 2px;
    border-radius: 4px;
    transition: color var(--transition);
}

.entity-popover__close:hover { color: var(--color-text); }

.entity-popover__actions {
    display: flex;
    flex-direction: column;
    padding: 8px;
    gap: 4px;
}

.entity-popover__action {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 9px 12px;
    border-radius: var(--radius-sm);
    text-decoration: none;
    color: var(--color-text);
    font-size: 0.88rem;
    font-weight: 600;
    transition: background var(--transition);
    border: 1px solid transparent;
}

.entity-popover__dismiss {
    background: transparent;
    text-align: left;
    width: 100%;
    cursor: pointer;
}

.entity-popover__action:hover {
    background: var(--color-surface-alt);
    border-color: var(--color-border);
}

.entity-popover__action--primary {
    color: var(--color-primary);
    background: var(--color-primary-muted);
    border-color: rgba(37, 99, 235, 0.2);
}

.entity-popover__action--primary:hover {
    background: rgba(37, 99, 235, 0.18);
}

.entity-popover__action-icon {
    font-size: 1rem;
    opacity: 0.7;
}

.entity-popover__network-detail {
    border-top: 1px solid var(--color-border);
}

.entity-popover__network-detail summary {
    padding: 8px 12px;
    font-size: 0.82rem;
    font-weight: 600;
    color: var(--color-text-muted);
    cursor: pointer;
    user-select: none;
    list-style: none;
}

.entity-popover__network-detail summary::-webkit-details-marker { display: none; }

.entity-popover__network-preview {
    padding: 8px 12px 12px;
}

.entity-popover__degree {
    font-size: 0.8rem;
    color: var(--color-text-muted);
    margin: 0 0 6px;
}

.entity-popover__connections ul {
    list-style: none;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.entity-popover__connections li {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.83rem;
}

.entity-popover__edge-weight {
    margin-left: auto;
    color: var(--color-text-subtle);
    font-size: 0.78rem;
}

/* Research typography for historian answers */
.agent-message__bubble--research {
    font-size: 1rem;
    line-height: 1.85;
    color: var(--color-text);
    width: 100%;
    max-width: none;
}

/* Explicit assistant-bubble width guard so the answer pane fills the available row. */
.agent-message--assistant .agent-message__bubble--research {
    width: 100%;
    max-width: none;
}

.agent-message__bubble--research p {
    margin-bottom: 1em;
}

.agent-message__bubble--research p:last-child {
    margin-bottom: 0;
}

/* Footnote superscripts */
.fn-ref {
    line-height: 0;
    vertical-align: super;
    font-size: 0.72em;
}

.fn-link {
    color: var(--color-primary);
    text-decoration: none;
    font-weight: 700;
    padding: 0 1px;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition);
}

.fn-link:hover {
    border-bottom-color: var(--color-primary);
}

.fn-link-sep {
    color: var(--color-primary);
    opacity: 0.7;
}

/* Footnote block */
.agent-footnotes {
    margin-top: 20px;
    padding-top: 16px;
    border-top: 1px solid var(--color-border);
}

.agent-footnotes__heading {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: var(--color-text-muted);
    font-family: 'Montserrat', sans-serif;
    margin: 0 0 10px;
}

.agent-footnotes__list {
    list-style: none;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.agent-footnotes__item {
    display: flex;
    gap: 8px;
    font-size: 0.85rem;
    line-height: 1.5;
    color: var(--color-text-muted);
}

.fn-num {
    font-weight: 700;
    color: var(--color-primary);
    flex-shrink: 0;
    min-width: 16px;
}

.fn-citation {
    flex: 1;
}

.fn-citation em {
    font-style: italic;
    color: var(--color-text);
}

.fn-open {
    margin-left: 8px;
    color: var(--color-primary);
    text-decoration: none;
    font-weight: 600;
    font-size: 0.8rem;
    opacity: 0.7;
    transition: opacity var(--transition);
}

.fn-open:hover { opacity: 1; }

/* Structured historian answer sections */
.historian-gap {
    background: var(--color-surface-alt);
    border-left: 3px solid var(--color-warn-muted);
    border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
    padding: 10px 14px;
    margin-top: 16px !important;
    font-size: 0.92rem;
    color: var(--color-text-muted);
}

.historian-leads {
    background: var(--color-primary-muted);
    border-left: 3px solid var(--color-primary);
    border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
    padding: 10px 14px;
    margin-top: 8px !important;
    font-size: 0.92rem;
}

.historian-caveat {
    font-style: italic;
    color: var(--color-text-muted);
    font-size: 0.9rem;
}

/* Citation copy button */
.citation-copy-btn {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 5px 12px;
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    font-size: 0.82rem;
    font-weight: 600;
    color: var(--color-text-muted);
    cursor: pointer;
    transition: all var(--transition);
    margin-top: 6px;
}

.citation-copy-btn:hover {
    background: var(--color-surface-alt);
    color: var(--color-text);
    border-color: var(--color-border-strong);
}

.citation-copy-btn--success {
    background: var(--color-success-muted);
    color: var(--color-success);
    border-color: rgba(4, 120, 87, 0.2);
}

.citation-copy-btn__icon {
    font-size: 0.95rem;
}

/* Network person-first search */
.network-person-search {
    position: relative;
    max-width: 480px;
    margin-bottom: 20px;
}

.network-person-search__label {
    display: block;
    font-size: 0.78rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
    font-family: 'Montserrat', sans-serif;
    margin-bottom: 6px;
}

.network-person-search__row {
    position: relative;
    display: flex;
    align-items: center;
}

.network-person-search__input {
    width: 100%;
    padding: 10px 36px 10px 14px;
    border: 1px solid var(--color-border-strong);
    border-radius: var(--radius-md);
    font-size: 0.95rem;
    background: var(--color-bg);
    color: var(--color-text);
    transition: border-color var(--transition), box-shadow var(--transition);
}

.network-person-search__input:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 3px var(--color-primary-muted);
}

.network-person-search__clear {
    position: absolute;
    right: 10px;
    background: none;
    border: none;
    color: var(--color-text-muted);
    font-size: 1.1rem;
    cursor: pointer;
    padding: 0;
    line-height: 1;
    transition: color var(--transition);
}

.network-person-search__clear:hover { color: var(--color-text); }

.network-person-search__results {
    position: absolute;
    top: calc(100% + 4px);
    left: 0;
    right: 0;
    background: var(--color-bg);
    border: 1px solid var(--color-border-strong);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-lg);
    list-style: none;
    margin: 0;
    padding: 6px;
    z-index: 100;
    max-height: 320px;
    overflow-y: auto;
}

.person-search-result {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    border-radius: var(--radius-sm);
    cursor: pointer;
    transition: background var(--transition);
}

.person-search-result:hover {
    background: var(--color-surface-alt);
}

.person-search-result--empty {
    color: var(--color-text-muted);
    font-size: 0.88rem;
    cursor: default;
    justify-content: center;
}

.person-search-result__name {
    font-weight: 600;
    color: var(--color-text);
    font-size: 0.9rem;
}

.person-search-result__type {
    font-size: 0.72rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-subtle);
    font-family: 'Montserrat', sans-serif;
}
.ce-gap-card__title { margin: 0 0 10px; color: var(--palette-hex-92400e); font-size: 0.95rem; }
.ce-gap-card__suggestions { margin: 0; padding: 0; list-style: none; display: grid; gap: 6px; }
.ce-gap-card__suggestions li {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 12px;
    font-size: 0.88rem;
    color: var(--palette-hex-374151);
}
.ce-gap-card__link { color: var(--palette-hex-2563eb); text-decoration: none; white-space: nowrap; font-weight: 600; font-size: 0.82rem; }

/* Contradictions */
.ce-contradictions { display: grid; gap: 14px; }
.ce-contradiction-card { padding: 14px; border: 1px solid var(--palette-hex-e2e8f0); border-radius: 10px; display: grid; gap: 10px; }
.ce-contradiction-card__claims { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
@media (max-width: 640px) { .ce-contradiction-card__claims { grid-template-columns: 1fr; } }
.ce-contradiction-card__claim { padding: 10px 12px; border-radius: 8px; font-size: 0.88rem; }
.ce-contradiction-card__claim--a { background: var(--palette-hex-eff6ff); border: 1px solid var(--palette-hex-bfdbfe); }
.ce-contradiction-card__claim--b { background: var(--palette-hex-fef2f2); border: 1px solid var(--palette-hex-fecaca); }
.ce-contradiction-card__label {
    display: block;
    font-weight: 700;
    font-size: 0.75rem;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    margin-bottom: 4px;
    color: var(--palette-hex-64748b);
}
.ce-contradiction-card__claim--a .ce-contradiction-card__label { color: var(--palette-hex-1d4ed8); }
.ce-contradiction-card__claim--b .ce-contradiction-card__label { color: var(--palette-hex-b91c1c); }
.ce-contradiction-card__claim p { margin: 0; line-height: 1.5; }

/* Patterns */
.ce-patterns { display: grid; gap: 10px; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); }
.ce-pattern-card { padding: 12px 14px; background: var(--palette-hex-f8fafc); border: 1px solid var(--palette-hex-e2e8f0); border-radius: 10px; display: grid; gap: 6px; }
.ce-pattern-card__meta { display: flex; gap: 6px; flex-wrap: wrap; }
.ce-pattern-card p { margin: 0; font-size: 0.88rem; color: var(--palette-hex-374151); line-height: 1.5; }

/* Entities */
.ce-entity-grid { display: flex; flex-wrap: wrap; gap: 8px; }
.ce-entity-card {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    background: var(--palette-hex-f8fafc);
    border: 1px solid var(--palette-hex-e2e8f0);
    border-radius: 8px;
    font-size: 0.85rem;
}
.ce-entity-card__name { font-weight: 600; color: var(--palette-hex-1f2937); }

/* Tags / badges */
.ce-tag {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 999px;
    font-size: 0.75rem;
    font-weight: 600;
    background: var(--palette-hex-e0e7ff);
    color: var(--palette-hex-3730a3);
}
.ce-tag--type { background: var(--palette-hex-dcfce7); color: var(--palette-hex-166534); }
.ce-tag--conf-high { background: var(--palette-hex-dcfce7); color: var(--palette-hex-166534); }
.ce-tag--conf-medium { background: var(--palette-hex-fef9c3); color: var(--palette-hex-854d0e); }
.ce-tag--conf-low { background: var(--palette-hex-fee2e2); color: var(--palette-hex-991b1b); }

.ce-badge {
    display: inline-block;
    padding: 1px 8px;
    border-radius: 999px;
    background: var(--palette-hex-e2e8f0);
    color: var(--palette-hex-374151);
    font-size: 0.8rem;
    font-weight: 600;
    margin-left: 6px;
    vertical-align: middle;
}

.ce-q-score { font-size: 0.75rem; font-weight: 700; padding: 2px 6px; border-radius: 6px; }
.ce-q-score--good { background: var(--palette-hex-dcfce7); color: var(--palette-hex-166534); }
.ce-q-score--ok { background: var(--palette-hex-fef9c3); color: var(--palette-hex-854d0e); }
.ce-q-score--low { background: var(--palette-hex-fee2e2); color: var(--palette-hex-991b1b); }
.ce-q-docs { font-size: 0.75rem; color: var(--palette-hex-64748b); }

/* Collapsible sections */
.ce-collapsible summary { cursor: pointer; list-style: none; display: flex; align-items: center; }
.ce-collapsible summary::-webkit-details-marker { display: none; }
.ce-collapsible .ce-section__title { margin: 0; }
.ce-collapsible[open] summary { margin-bottom: 16px; }

/* Prefill note in historian agent */
.ce-prefill-note { margin: 0 0 8px; font-size: 0.85rem; color: var(--palette-hex-6366f1); font-weight: 500; }

/* Small button variant */
.button--sm { padding: 6px 14px; font-size: 0.85rem; border-radius: 8px; }
