# ==============================================================================
# 1. MONGODB CONFIGURATION (DOCKER & APP)
# ==============================================================================
MONGO_INITDB_ROOT_USERNAME=admin
MONGO_INITDB_ROOT_PASSWORD=secret

# Application Connection String
APP_MONGO_URI=mongodb://${MONGO_INITDB_ROOT_USERNAME}:${MONGO_INITDB_ROOT_PASSWORD}@mongodb:27017/admin
MONGO_URI=mongodb://${MONGO_INITDB_ROOT_USERNAME}:${MONGO_INITDB_ROOT_PASSWORD}@mongodb:27017/admin

# Database & Collection Names (For Metadata Hydration)
DB_NAME=railroad_documents
CHUNKS_COLLECTION=document_chunks
DOCS_COLLECTION=documents

# Legacy/Backwards Compatibility
MONGO_ROOT_USERNAME=${MONGO_INITDB_ROOT_USERNAME}
MONGO_ROOT_PASSWORD=${MONGO_INITDB_ROOT_PASSWORD}

# ==============================================================================
# 2. OLLAMA & LLM CONFIGURATION (SHARED)
# ==============================================================================
OLLAMA_BASE_URL=http://host.docker.internal:11434
HISTORIAN_AGENT_OLLAMA_BASE_URL=${OLLAMA_BASE_URL}

# Master Model Settings
LLM_MODEL=gpt-oss:20b
HISTORIAN_AGENT_MODEL=gpt-oss:20b
HISTORIAN_AGENT_MODEL_PROVIDER=ollama

# Performance & Behavior
LLM_TEMPERATURE=0.2
HISTORIAN_AGENT_TEMPERATURE=0.2
LLM_MAX_TOKENS=10000        # Maximum length of AI response
MAX_CONTEXT_TOKENS=100000    # Maximum historical data read (120k context window)

# ==============================================================================
# 3. EMBEDDING & VECTOR STORE
# ==============================================================================
HISTORIAN_AGENT_EMBEDDING_PROVIDER=ollama
HISTORIAN_AGENT_EMBEDDING_MODEL=qwen3-embedding:0.6b

HISTORIAN_AGENT_VECTOR_STORE=chroma
CHROMA_PERSIST_DIRECTORY=/data/chroma_db/persist
CHROMA_HOST_PATH=../chroma_db

# ==============================================================================
# 4. RERANKING & ADVERSARIAL PIPELINE
# ==============================================================================
# Reranker Model (Cross-Encoder)
CROSS_ENCODER_MODEL=cross-encoder/ms-marco-MiniLM-L-6-v2

# Reranking Weights (Must sum to 1.0)
CROSS_ENCODER_WEIGHT=0.85
TEMPORAL_WEIGHT=0.10
ENTITY_WEIGHT=0.05

# Search Depths
HISTORIAN_AGENT_TOP_K=100    # Initial pool size for retrieval
FINAL_TOP_K=10               # Final docs sent to LLM after reranking

# Retrieval Balance
VECTOR_WEIGHT=0.7            # Semantic influence
KEYWORD_WEIGHT=0.3           # Keyword/Exact Match influence
HISTORIAN_AGENT_HYBRID_ALPHA=0.5

# Critique Settings
CRITIQUE_TEMPERATURE=0.1

# ==============================================================================
# 5. FLASK & SYSTEM CONFIGURATION
# ==============================================================================
SECRET_KEY=super-secret-key
FLASK_ENV=development
FLASK_DEBUG=1

HISTORIAN_AGENT_ENABLED=1
HISTORIAN_AGENT_CONTEXT_K=4
HISTORIAN_AGENT_CONTEXT_FIELDS=title,content
HISTORIAN_AGENT_SUMMARY_FIELD=content
HISTORIAN_AGENT_FALLBACK=1
HISTORIAN_AGENT_USE_VECTOR_RETRIEVAL=true

# Processing Settings
HISTORIAN_AGENT_CHUNK_SIZE=1000
HISTORIAN_AGENT_CHUNK_OVERLAP=200
RUN_BOOTSTRAP=0

# API Keys
OPENAI_API_KEY=

# ==============================================================================
# 6. SYSTEM PATHS
# ==============================================================================
ARCHIVES_PATH=/data/archives/
ARCHIVES_HOST_PATH=../archives/borr_data/
MONGO_DATA_PATH=/data/db
MONGO_DATA_HOST_PATH=../mongo_data
SESSION_PATH=/app/flask_session
SESSION_HOST_PATH=../flask_session